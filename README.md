ManualTestsHelper - скрипты, которые автоматизируют рутинные действия при проверках на виндовой кассе.

Сами скрипты написаны на питоне, а запускаются горячими клавишами благодаря AutoHotKey.

## Как запустить

1. Установите AutoHotKey - приложение для создания горячих клавиш https://www.autohotkey.com/
2. Установите питон третьей версии. Обязательно поставьте галочку в "Добавить в Path". https://www.python.org/downloads/
3. Выкачайте этот репозиторий 
4. В папке helpers запустите от администратора libinstaller.bat. Он установит две необходимых библиотеки + создаст файл data.json.
5. В файле data.json: убедитесь, что перечислен ваш жесткий диск, на котором лежит Касса. Остальные строки заполняются сами.
6. Запустите CashboxHotkeys.ahk от администратора (так все скрипты тоже будут запускаться от администратора)

Простого способа запускать CashboxHotkeys.ahk автоматически при включении ПК пока нет. Автозагрузка не работает из-за необходимости админских прав. Обходной путь - настроить правило в планировщике задач Windows. Его можно найти в меню Пуск, и он интуитивно понятен.

## Как пользоваться

После запуска файла .ahk можно нажимать на горячие клавиши.

| Горячие клавиши | Действие | Пояснение|
|----:|:----:|:----------|
|ALT + стрелка вниз  | Остановка службы SKBKontur.Cashbox |  |
|ALT + стрелка вверх | Запуск службы SKBKontur.Cashbox |  |
|ALT + d |Удаление базы данных кассы | Удаление папки db из папки Cashbox |
|ALT + c | Удаление кассы | Удаление папки Cashbox |
|ALT + p | Вставить cashboxId из буфера в файл data.json | Чтобы сгенерировать токен для этой КМК в следующем скрипте |
|ALT + t| Генерация нового токена| Код активации сгенерируется для кассы, которая указана в файле data.json |
|ALT + 1| Переключение на стейджинг-1 | В конфиге адрес лояльности заменится на: market.testkontur... |
|ALT + 2 | Переключение на стейджинг-2  | В конфиге адрес лояльности заменится на: market-dev.testkontur... |
|ALT + o | Изменение настройки переноса остатков | MoveRemainsToNextShift - заменяем настройку с тру на фолс или с фолс на тру |
|ALT + i | Скопировать в буфер id текущей кассы | Скрипт возьмёт cashboxId из базы в SQLite |
|ALT + - | Сделать текущую смену > 24 часов | Скрипт поправит дату начала смены в базе SQLite |

Также работает автозамена строк. Просто напишите ключ где угодно, например, в строке браузера - подставится значение:

:white_check_mark: adm1 - https://market.testkontur.ru/AdminTools

:white_check_mark: adm2 - https://market-dev.testkontur.ru/AdminTools

:white_check_mark: cashdoc - https://cashdoc.kontur/webdav/cashbox/

:white_check_mark: csadm - https://market.kontur.ru/cashboxApi/admin/web/cashbox/

____

:cat: *Расширяйте набор скриптов и горячих клавиш по аналогии и подстраивайте их под себя. 
Или хотя бы расказывайте, чего не хватает :)* 

